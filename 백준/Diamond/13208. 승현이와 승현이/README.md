# [Diamond IV] 승현이와 승현이 - 13208 

[문제 링크](https://www.acmicpc.net/problem/13208) 

### 성능 요약

메모리: 18012 KB, 시간: 936 ms

### 분류

이분 탐색(binary_search), 자료 구조(data_structures), 분리 집합(disjoint_set), 그래프 이론(graphs), 최소 공통 조상(lca), 최소 스패닝 트리(mst), 병렬 이분 탐색(pbs), 트리(trees)

### 문제 설명

<p>석환나라에는 조승현이라는 이름을 가진 사람이 두 명이 있다. 헷갈리니까 한 명은 조승현13 이라 하고 한 명은 조승현16 이라 하자. 이 둘은 원래 서로의 존재를 모르고 있다가 얼마전에 뉴스를 보고 알게 되었다. 자신과 같은 이름을 가진 사람이 존재한다는 것이 너무 신기했던 그 둘은 연락처를 알아내서 서로 연락하는 사이가 되었다.</p>

<p>어느 날 그 들은 상대방이 사는 도시에 대해 궁금해졌다. 전화로 서로의 도시에 대해 설명해주다가 지친 그 들은 결국 상대방의 도시에 여행을 가기로 결정했다.</p>

<p>석환나라는 <em>N</em> 개의 도시로 이루어져 있고 도시마다 번호가 1부터 <em>N</em> 까지 붙어있다. 그 사이에 도시들을 연결하는 도로 <em>M</em> 개가 있다. 하나의 도로는 도시 두개를 연결하고 그 사이를 양방향으로 다닐 수 있게 한다. 그리고 임의의 한 도시에서 출발하여 도로를 적당히 거쳐가면 다른 모든 도시에 도착할 수 있음이 보장되어있다.</p>

<p>현재 조승현13은 <em>S</em> 번 도시에 있고 조승현16은 <em>E</em> 번 도시에 살고있다. 이 둘은 상대방에게 자신의 도시로 가는 길을 설명해주기 위해 전화로 연락을 유지하면서 다음과 같은 방법으로 여행한다.</p>

<ol>
	<li>0일차에 조승현13은 <em>S</em> 번 도시에, 조승현16은 <em>E</em> 번 도시에 있다.</li>
	<li><em>i</em>일차 (<em>i</em> ≥ 0)의 아침에 둘은 전화로 연락하여 오늘 누가 움직일지 결정한다. 하루에 둘 중 한 명만 움직일 수 있다.</li>
	<li>이동하기로 결정된 사람은 현재 위치한 도시에 연결된 도로 중 하나를 골라 그 도로를 따라 이동하고, 반대편 도시에 도착하면 이동을 마친다. 이 과정은 석양이 지기 전에 항상 완료된다.</li>
	<li><em>i</em>일차의 석양이 진 후에 둘은 다시 전화로 연락하여 서로의 생사를 확인한다.</li>
	<li>생사를 확인한 직후에 조승현13이 <em>E</em>번 도시에, 조승현16이 <em>S</em>번 도시에 있는 상태라면 여행을 종료한다. 그렇지 않다면, 숙소에서 자고 일어난 후 2번 과정으로 돌아가 반복한다.</li>
</ol>

<p>전화로 연락하기 위해서는 각자 갖고 있는 전화기가 일정 수준 이상의 무선 신호 출력을 낼 수 있어야 한다. 각 도시 <em>i</em> 마다 무선 신호가 잘 퍼지는지 아닌지를 나타내는 양의 정수 <em>C<sub>i</sub></em> 가 있을 때, 두 도시 <em>a</em>, <em>b</em> 사이에서 전화를 하려면 전화기가 <em>C<sub>a</sub></em> × <em>C<sub>b</sub></em> 이상의 출력을 낼 수 있어야 한다. 이 법칙은 이상한 일이지만 두 명이 같은 도시 안에 있어도 여전히 적용된다.</p>

<p>두 조승현은 여행을 시작하기전에 똑같은 전화기를 하나씩 사서 여행이 끝날 때 까지 그 전화기만 사용할 것이다. 전화기의 가격은 전화기가 낼 수 있는 출력에 비례하기 때문에, 어떻게 여행하느냐에 따라 필요한 전화기의 가격이 변한다. <em>S</em> 와 <em>E</em> 가 주어졌을 때, 여행을 무사히 마치기 위해 필요한 전화기의 출력의 최솟값을 구해서 두 조승현을 만족시켜주자.</p>

### 입력 

 <p>주의 : 이 문제의 입력은 하나의 테스트 케이스로 구성되어 있다.</p>

<p>첫 번째 줄에 도시의 수 <em>N</em> (2 ≤ <em>N</em> ≤ 500)과 도로의 수 <em>M</em> (1 ≤ <em>M</em> ≤ 3, 000)이 주어진다. 두 번째 줄에 <em>N</em> 개의 정수가 주어진다. <em>i</em>번째 정수는 <em>C<sub>i</sub></em> (1 ≤ <em>C<sub>i</sub></em> ≤ 40, 000) 를 나타내며 이것은 <em>i</em>번 도시의 무선 신호 상수를 나타낸다.</p>

<p>이후로 <em>M</em> 개의 줄에 걸쳐 2개의 정수 <em>a</em>, <em>b</em> (1 ≤ <em>a</em>, <em>b</em> ≤ <em>N</em>, <em>a</em> ≠ <em>b</em>) 가 공백으로 구분되어 주어지는데, 이것은 도시 <em>a</em>와 도시 <em>b</em> 사이를 잇는 도로가 존재함을 뜻한다.</p>

<p>그 다음 줄에 질문의 수 <em>Q</em> (1 ≤ <em>Q</em> ≤ <em><sub>n</sub></em>C<sub>2</sub>) 가 주어진다. 이후로 <em>Q</em> 개의 줄에 걸쳐 2개의 정수 <em>S</em>, <em>E</em> (1 ≤ <em>S</em>, <em>E</em> ≤ <em>N</em>, <em>S</em> ≠ <em>E</em>) 가 공백으로 구분되어 주어지는데, 이것은 처음에 조승현13이 <em>S</em> 번 도시에 있고 조승현16이 <em>E</em> 번 도시에 있을 때의 상황을 뜻하는 것이다.</p>

### 출력 

 <p><em>Q</em> 개의 줄에 각 질문에 대해 여행을 성공적으로 마치기 위해 필요한 전화기의 출력의 최솟값을 구하여 출력한다.</p>

