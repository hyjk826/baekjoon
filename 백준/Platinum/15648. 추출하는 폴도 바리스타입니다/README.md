# [Platinum IV] 추출하는 폴도 바리스타입니다 - 15648 

[문제 링크](https://www.acmicpc.net/problem/15648) 

### 성능 요약

메모리: 13524 KB, 시간: 300 ms

### 분류

자료 구조(data_structures), 다이나믹 프로그래밍(dp), 세그먼트 트리(segtree)

### 문제 설명

<p>추출하는 폴은 바리스타입니다. 폴에게는 커피콩 <em>N</em>개가 순서대로 주어집니다. 폴은 이 중 몇 개를 골라서 추출할 예정입니다. 이때, 최종 결과물의 질이 좋아야 할 것입니다. 결과물의 질이 좋기 위해서는, 커피콩들의 종류(정수로 표현됩니다.)로 이루어진 수열의 부분수열을 <em>A</em>라고 하면, 2 이상의 모든 i 에 대해 <em>A</em><sub><em>i</em> - 1</sub> ≡ <em>A</em><sub><em>i</em></sub> (<em>mod</em> <em>k</em>) 나 <em>A</em><sub><em>i</em> - 1</sub> - <em>d</em> ≤ <em>A</em><sub><em>i</em></sub> ≤ <em>A</em><sub><em>i</em> - 1</sub> + <em>d</em>를 만족함을 뜻합니다.</p>

<p>폴을 위해서 질이 좋은 커피 추출물 중 가장 많은 커피콩을 고를 때 그 개수를 구해주세요.</p>

### 입력 

 <p>첫째 줄에 <em>N</em>, <em>k</em> 와 <em>d</em>가 주어집니다. (1 ≤ <em>N</em> ≤ 5 × 10<sup>5</sup>, 1 ≤ <em>k</em>, <em>d</em> ≤ 5 × 10<sup>5</sup>)</p>

<p><em>N</em>개의 커피콩의 순서와 각각의 번호를 나타내는 길이 <em>N</em>의 배열 <em>S</em>가 다음 줄에 주어집니다. (1 ≤ <em>S</em><sub><em>i</em></sub> ≤ 5 × 10<sup>5</sup>)</p>

### 출력 

 <p>질이 좋은 커피 추출물 중 가장 많은 커피콩을 고를 때 그 개수를 출력합니다.</p>

